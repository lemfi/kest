<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Steps :: Kest</title>
    <link rel="canonical" href="https://lemfi.github.io/kest/steps.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="steps/http.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../kest/css/site.css">
    <script>var uiRootPath = '../kest'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://lemfi.github.io/kest">Kest</a>
  <div class="navbar-item search hide-for-print">
    <div id="search-field" class="field">
      <input id="search-input" type="text" placeholder="Search">
    </div>
  </div>
  </nav>

</header>
<div class="body">
<div class="nav-container" data-component="kest" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Kest</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="steps.html">Steps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Available steps</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="steps/http.html">HTTP Steps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="steps/rabbitmq.html">RabbitMQ Steps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="steps/mongodb.html">MongoDB Steps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="steps/mariadb.html">MariaDB Steps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="steps/create-step.html">Create a custom step</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="json.html">JSON support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="gherkin.html">Gherkin support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configuration.html">Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Kest</a></li>
    <li><a href="steps.html">Steps</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Steps</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A step is where interaction with your system happen, it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>has a name</p>
</li>
<li>
<p>can be retried</p>
</li>
<li>
<p>has an execution</p>
</li>
<li>
<p>has a list of assertions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">step(
    name = "a name a step has",
    retry = 10.times byIntervalsOf 200.ms, // if assertions of step fail, step will be retried 10 times by intervals of 200 ms before really failing. Useful if you have asynchonous stuff going on on your backends.
) {
    // here goes the definition of the execution
} assertThat {
    // here goes list of assertions
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="available-steps"><a class="anchor" href="#available-steps"></a>Available Steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="http"><a class="anchor" href="#http"></a><a href="steps/http.html" class="xref page">HTTP</a></h3>

</div>
<div class="sect2">
<h3 id="rabbitmq"><a class="anchor" href="#rabbitmq"></a><a href="steps/rabbitmq.html" class="xref page">RabbitMQ</a></h3>

</div>
<div class="sect2">
<h3 id="mongodb"><a class="anchor" href="#mongodb"></a><a href="steps/mongodb.html" class="xref page">MongoDB</a></h3>

</div>
<div class="sect2">
<h3 id="mariadb"><a class="anchor" href="#mariadb"></a><a href="steps/mariadb.html" class="xref page">MariaDB</a></h3>

</div>
<div class="sect2">
<h3 id="redis"><a class="anchor" href="#redis"></a>Redis</h3>

</div>
<div class="sect2">
<h3 id="cadence"><a class="anchor" href="#cadence"></a>Cadence</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="create-your-own-step"><a class="anchor" href="#create-your-own-step"></a>Create your own step</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need custom steps not provided by Kest? Two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use generic step <code>step</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">step(name = "name of my step") {

    // execute your need here
    1+1

} assertThat { stepResult -&gt;

    stepResult isEqualTo 2

}</code></pre>
</div>
</div>
</li>
<li>
<p><a href="steps/create-step.html" class="xref page">Create your own one</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nested-scenario"><a class="anchor" href="#nested-scenario"></a>Nested scenario</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to group some steps together to make your scenario clearer you may use a particular step that allows that</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">nestedScenario("group steps") {
    step(name = "step1") { /*...*/ }
    step(name = "step2") { /*...*/ }
    step(name = "step3") { /*...*/ }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reuse-result-of-one-step-in-another-one"><a class="anchor" href="#reuse-result-of-one-step-in-another-one"></a>Reuse result of one step in another one</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you create a step, you call a function that will return a <code>StepResult</code><br>
It&#8217;s on that <code>StepResult</code> that make assertions.<br>
It&#8217;s also on that <code>StepResult</code> that you can retrieve the result of the step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val step1: StepResult&lt;Int&gt; = step { 1+1 } assertThat { it isEqualTo 2 }

val step2: StepResult&lt;Double&gt; = step { step1() + 1.5 } assertThat { it isEqualTo 3.5 }

step { step2.invoke().toString() } assertThat { it isEqualTo "3.5" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see on the example, to get the result of a step you may invoke it.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
you may use the result of a step only in the execution of another step, if you try to invoke it outside an execution then the step will probably not have been played yet so no result will be available.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="special-case-of-a-nestedscenario"><a class="anchor" href="#special-case-of-a-nestedscenario"></a>Special case of a nestedScenario</h3>
<div class="paragraph">
<p><code>nestedScenario</code> step is a particular step that does not return any result by default.<br>
It is still possible to return a result from a <code>nestedScenario</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val step1 = nestedScenario&lt;Double&gt; {

    val step11: StepResult&lt;Int&gt; = step { 1+1 } assertThat { it isEqualTo 2 }

    val step12: StepResult&lt;Double&gt; = step { step11() + 1.5 } assertThat { it isEqualTo 3.5 }

    returns { step12() }
}

step { step1() + 4 } assertThat { it isEqualTo 7.5 }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transform-the-result-of-a-step"><a class="anchor" href="#transform-the-result-of-a-step"></a>Transform the result of a step</h3>
<div class="paragraph">
<p>You may transform a result of a step so that later steps reusing the result will reuse transformed result instead of initial one</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val step1 = step { 1 + 1 } mapResultTo { it * 1.0 } assertThat { it isEqualTo 2 }

step { step1() * 3 } assertThat { it isEqualTo 18.0 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here step1 result was transformed from an Int to a Double <br>
Even though in assertions of step 1 the result is still an Int: Assertions are always done on initial result, not transformed one.<br>
Then when second step invoked step1 result it got a Double<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Take care, when you use <code>mapResultTo</code> it will not transform the result for the assertions of the step, assertions are always done on step initial result.<br>
Moreover,  <code>mapResultTo</code> lambda will only be executed when the result of its step will be invoked: if result of that step is never invoked, then <code>mapResultTo</code> lambda will never be executed.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Overview</a></span>
  <span class="next"><a href="steps/http.html">HTTP Steps</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../kest/js/site.js" data-ui-root-path="../kest"></script>
<script async src="../kest/js/vendor/highlight.js"></script>
<script src="../kest/js/vendor/lunr.js"></script>
<script src="../kest/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../kest/css/search.css"></script>
<script async src="../kest/search-index.js"></script>
  </body>
</html>
